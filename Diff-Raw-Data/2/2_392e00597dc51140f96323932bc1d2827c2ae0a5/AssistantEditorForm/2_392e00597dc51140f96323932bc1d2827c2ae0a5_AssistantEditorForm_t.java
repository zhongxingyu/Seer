 package de.aidger.view.forms;
 
 import static de.aidger.utils.Translation._;
 
 import javax.swing.JPanel;
 
 import de.aidger.model.models.Assistant;
 import de.aidger.view.forms.HourlyWageEditorForm.Qualification;
 
 /**
  * A form used for editing / creating new assistants.
  * 
  * @author aidGer Team
  */
 @SuppressWarnings("serial")
 public class AssistantEditorForm extends JPanel {
 
     /**
      * Constructs an assistant editor form.
      * 
      * @param assistant
      *            The assistant who will be edited
      */
     public AssistantEditorForm(Assistant assistant) {
         initComponents();
 
         if (assistant != null) {
             txtFirstName.setText(assistant.getFirstName());
             txtLastName.setText(assistant.getLastName());
             txtEmail.setText(assistant.getEmail());
             cmbQualification.setSelectedItem(Qualification.valueOf(assistant
                 .getQualification()));
         }
     }
 
     /**
      * Get the email address of the assistant.
      * 
      * @return The email address of the assistant
      */
     public String getEmail() {
         return txtEmail.getText();
     }
 
     /**
      * Get the first name of the assistant.
      * 
      * @return The first name of the assistant
      */
     public String getFirstName() {
         return txtFirstName.getText();
     }
 
     /**
      * Get the last name of the assistant.
      * 
      * @return The last name of the assistant.
      */
     public String getLastName() {
         return txtLastName.getText();
     }
 
     /**
      * Get the qualification level of the assistant.
      * 
      * @return The qualification level of the assistant
      */
     public String getQualification() {
         return ((Qualification) cmbQualification.getSelectedItem()).name();
     }
 
     /**
      * This method is called from within the constructor to initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is always
      * regenerated by the Form Editor.
      */
     // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
     private void initComponents() {
         java.awt.GridBagConstraints gridBagConstraints;
 
         lblFirstName = new javax.swing.JLabel();
         lblLastName = new javax.swing.JLabel();
         lblEmail = new javax.swing.JLabel();
         lblQualification = new javax.swing.JLabel();
         txtFirstName = new javax.swing.JTextField();
         txtLastName = new javax.swing.JTextField();
         txtEmail = new javax.swing.JTextField();
         cmbQualification = new javax.swing.JComboBox();
 
         setLayout(new java.awt.GridBagLayout());
 
         lblFirstName.setText(_("First Name"));
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(lblFirstName, gridBagConstraints);
 
         lblLastName.setText(_("Last Name"));
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.gridx = 0;
         gridBagConstraints.gridy = 1;
         gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(lblLastName, gridBagConstraints);
 
         lblEmail.setText(_("Email"));
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.gridx = 0;
         gridBagConstraints.gridy = 2;
         gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(lblEmail, gridBagConstraints);
 
         lblQualification.setText(_("Qualification"));
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.gridx = 0;
         gridBagConstraints.gridy = 3;
         gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(lblQualification, gridBagConstraints);
 
         txtFirstName.setMinimumSize(new java.awt.Dimension(200, 25));
         txtFirstName.setPreferredSize(new java.awt.Dimension(200, 25));
         txtFirstName.addFocusListener(new java.awt.event.FocusAdapter() {
             public void focusLost(java.awt.event.FocusEvent evt) {
                 updateEmailOnFocusLost(evt);
             }
         });
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(txtFirstName, gridBagConstraints);
 
         txtLastName.setMinimumSize(new java.awt.Dimension(200, 25));
         txtLastName.setPreferredSize(new java.awt.Dimension(200, 25));
         txtLastName.addFocusListener(new java.awt.event.FocusAdapter() {
             public void focusLost(java.awt.event.FocusEvent evt) {
                 updateEmailOnFocusLost(evt);
             }
         });
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.gridx = 1;
         gridBagConstraints.gridy = 1;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(txtLastName, gridBagConstraints);
 
         txtEmail.setMinimumSize(new java.awt.Dimension(200, 25));
         txtEmail.setPreferredSize(new java.awt.Dimension(200, 25));
         txtEmail.addFocusListener(new java.awt.event.FocusAdapter() {
             public void focusLost(java.awt.event.FocusEvent evt) {
                 txtEmailFocusLost(evt);
             }
         });
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.gridx = 1;
         gridBagConstraints.gridy = 2;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(txtEmail, gridBagConstraints);
 
         cmbQualification.setModel(new javax.swing.DefaultComboBoxModel(Qualification.values()));
         gridBagConstraints = new java.awt.GridBagConstraints();
         gridBagConstraints.gridx = 1;
         gridBagConstraints.gridy = 3;
         gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
         gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
         add(cmbQualification, gridBagConstraints);
     }// </editor-fold>//GEN-END:initComponents
 
     private void txtEmailFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtEmailFocusLost
        if (!txtEmail.getText().isEmpty() && txtEmail.getText().contains("@")) {
             String[] email = txtEmail.getText().split("@", 2);
             if (email[1].equals("studi")) {
                 txtEmail.setText(email[0] + "@studi.informatik.uni-stuttgart.de");
             }
         }
     }//GEN-LAST:event_txtEmailFocusLost
 
     /**
      * Update the email address if first or last name got updated and email is
      * empty or a studimail address.
      * @param evt
      */
     private void updateEmailOnFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_updateEmailOnFocusLost
         if (!txtFirstName.getText().isEmpty() &&
                 !txtLastName.getText().isEmpty() && (txtEmail.getText().isEmpty()  
                 || txtEmail.getText().split("@", 2)[1].equals(
                 "studi.informatik.uni-stuttgart.de"))) {
             String username;
             if (txtLastName.getText().length() >= 6) {
                 username = txtLastName.getText().toLowerCase().substring(0, 6);
             } else {
                 username = txtLastName.getText().toLowerCase();
             }
 
             txtEmail.setText(username +
                     txtFirstName.getText().toLowerCase().charAt(0) + 
                     txtFirstName.getText().toLowerCase().charAt(
                         txtFirstName.getText().length() - 1) +
                     "@studi.informatik.uni-stuttgart.de");
         }
     }//GEN-LAST:event_updateEmailOnFocusLost
 
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JComboBox cmbQualification;
     private javax.swing.JLabel lblEmail;
     private javax.swing.JLabel lblFirstName;
     private javax.swing.JLabel lblLastName;
     private javax.swing.JLabel lblQualification;
     private javax.swing.JTextField txtEmail;
     private javax.swing.JTextField txtFirstName;
     private javax.swing.JTextField txtLastName;
     // End of variables declaration//GEN-END:variables
 
 }
