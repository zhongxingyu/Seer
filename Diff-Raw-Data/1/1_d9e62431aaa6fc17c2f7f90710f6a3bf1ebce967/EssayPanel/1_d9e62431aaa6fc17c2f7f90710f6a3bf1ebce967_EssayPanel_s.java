 /*
  * To change this template, choose Tools | Templates
  * and open the template in the editor.
  */
 package melt.View.marker;
 
 import javax.swing.JOptionPane;
 import melt.Controller;
 import melt.Model.Essay;
 import melt.Model.Mcq;
 import melt.Model.Subsection;
 
 /**
  *
  * @author mbaxjah5
  */
 public class EssayPanel extends javax.swing.JPanel {
 
     private Subsection subsectionObject;
     private Controller controller;
     private Essay essayObject;
 
     /**
      * Creates new form EssayJPanel
      */
     public EssayPanel(Controller controller) {
         initComponents();
         this.controller = controller;
 
     }
 
     public void setQuestion(Essay essay) {
         this.essayObject = essay;
         preview();
     }
 
     public void setSubsectionObject(Subsection subsection) {
         this.subsectionObject = subsection;
     }
 
     private boolean isNumeric(String str) {
         return str.matches("\\d+(\\.\\d+)?");
     }
 
     /**
      * This method is called from within the constructor to initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is always
      * regenerated by the Form Editor.
      */
     @SuppressWarnings("unchecked")
     // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
     private void initComponents() {
 
         lblTitle = new javax.swing.JLabel();
         jScrollPane1 = new javax.swing.JScrollPane();
         txtEssayAnswer = new javax.swing.JTextArea();
         lblEssayQuestion = new javax.swing.JLabel();
         lblMarks1 = new javax.swing.JLabel();
         lblMarks = new javax.swing.JLabel();
         lblWordCount = new javax.swing.JLabel();
         btnMark = new javax.swing.JButton();
         labelWordLimit = new javax.swing.JLabel();
         labelNumOfWords = new javax.swing.JLabel();
         txtFieldMarks = new javax.swing.JTextField();
         FullMarksInfoLabel = new javax.swing.JLabel();
         labelEssayFullMarks = new javax.swing.JLabel();
 
         lblTitle.setFont(new java.awt.Font("Snap ITC", 0, 30)); // NOI18N
         lblTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
         lblTitle.setText("Essay Question");
         lblTitle.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
 
         txtEssayAnswer.setColumns(20);
         txtEssayAnswer.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
         txtEssayAnswer.setLineWrap(true);
         txtEssayAnswer.setRows(5);
         jScrollPane1.setViewportView(txtEssayAnswer);
 
         lblEssayQuestion.setText("Essay Question: ");
 
         lblMarks1.setFont(new java.awt.Font("MV Boli", 0, 16)); // NOI18N
         lblMarks1.setText("Word Limit:");
 
         lblMarks.setFont(new java.awt.Font("MV Boli", 0, 16)); // NOI18N
         lblMarks.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
         lblMarks.setText("Student Marks:");
         lblMarks.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
 
         lblWordCount.setFont(new java.awt.Font("MV Boli", 0, 16)); // NOI18N
         lblWordCount.setText("Word Count:");
 
         btnMark.setText("Mark");
         btnMark.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnMarkActionPerformed(evt);
             }
         });
 
         txtFieldMarks.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 txtFieldMarksActionPerformed(evt);
             }
         });
 
         FullMarksInfoLabel.setFont(new java.awt.Font("MV Boli", 0, 16)); // NOI18N
         FullMarksInfoLabel.setText("Essay Full Marks:");
 
         javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
         this.setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(layout.createSequentialGroup()
                 .addGap(38, 38, 38)
                 .addComponent(lblTitle, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addGap(69, 69, 69))
             .addGroup(layout.createSequentialGroup()
                 .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                     .addGroup(layout.createSequentialGroup()
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                             .addComponent(lblEssayQuestion, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                             .addGroup(layout.createSequentialGroup()
                                 .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 576, javax.swing.GroupLayout.PREFERRED_SIZE)
                                 .addGap(0, 0, Short.MAX_VALUE))
                             .addGroup(layout.createSequentialGroup()
                                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                     .addGroup(layout.createSequentialGroup()
                                         .addComponent(lblWordCount)
                                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                         .addComponent(labelNumOfWords, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE))
                                     .addGroup(layout.createSequentialGroup()
                                         .addComponent(FullMarksInfoLabel)
                                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                         .addComponent(labelEssayFullMarks, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                                         .addGap(73, 73, 73)
                                         .addComponent(lblMarks)))
                                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                 .addComponent(txtFieldMarks, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                                 .addGap(18, 18, 18)
                                 .addComponent(btnMark, javax.swing.GroupLayout.PREFERRED_SIZE, 74, javax.swing.GroupLayout.PREFERRED_SIZE)))
                         .addContainerGap())
                     .addGroup(layout.createSequentialGroup()
                         .addComponent(lblMarks1)
                         .addGap(18, 18, 18)
                         .addComponent(labelWordLimit, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                         .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(layout.createSequentialGroup()
                 .addContainerGap()
                 .addComponent(lblTitle)
                 .addGap(36, 36, 36)
                 .addComponent(lblEssayQuestion, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                 .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 220, javax.swing.GroupLayout.PREFERRED_SIZE)
                 .addGap(18, 18, 18)
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                     .addComponent(labelWordLimit, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                     .addComponent(lblMarks1))
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                     .addGroup(layout.createSequentialGroup()
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                             .addComponent(lblWordCount, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                             .addComponent(labelNumOfWords, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                             .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                 .addComponent(FullMarksInfoLabel)
                                 .addComponent(lblMarks))
                             .addComponent(labelEssayFullMarks, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                     .addGroup(layout.createSequentialGroup()
                         .addGap(18, 18, 18)
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                             .addComponent(txtFieldMarks, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
                             .addComponent(btnMark, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE))))
                 .addContainerGap())
         );
     }// </editor-fold>//GEN-END:initComponents
 
     private void btnMarkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMarkActionPerformed
         // TODO add your handling code here:
         // TODO add your handling code here:
         if (this.txtFieldMarks.getText().equals("")) {
             JOptionPane.showMessageDialog(this, "You need to set a mark for the essay.");
         } else if (!(isNumeric(this.txtFieldMarks.getText()))) {
             JOptionPane.showMessageDialog(this, "You need to set number to mark the essay");
         } else {
             String mark = txtFieldMarks.getText();
             double markDouble = Double.parseDouble(mark);
             if (markDouble > this.essayObject.getMark()) {
                 JOptionPane.showMessageDialog(this, "Please enter less or equal marks to the full marks for the essay");
             }
             this.essayObject.setStudentMark(markDouble);
             this.controller.updateStudentFile();
         }
     }//GEN-LAST:event_btnMarkActionPerformed
 
     private void txtFieldMarksActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtFieldMarksActionPerformed
         // TODO add your handling code here:
     }//GEN-LAST:event_txtFieldMarksActionPerformed
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JLabel FullMarksInfoLabel;
     private javax.swing.JButton btnMark;
     private javax.swing.JScrollPane jScrollPane1;
     private javax.swing.JLabel labelEssayFullMarks;
     private javax.swing.JLabel labelNumOfWords;
     private javax.swing.JLabel labelWordLimit;
     private javax.swing.JLabel lblEssayQuestion;
     private javax.swing.JLabel lblMarks;
     private javax.swing.JLabel lblMarks1;
     private javax.swing.JLabel lblTitle;
     private javax.swing.JLabel lblWordCount;
     private javax.swing.JTextArea txtEssayAnswer;
     private javax.swing.JTextField txtFieldMarks;
     // End of variables declaration//GEN-END:variables
 
     private void clear() {
         lblEssayQuestion.setText("");
         txtEssayAnswer.setText("");
         labelWordLimit.setText("");
         labelNumOfWords.setText("");
         labelEssayFullMarks.setText("");
         txtFieldMarks.setText("");
     }
     private void preview() {
         
         clear();
         lblEssayQuestion.setText("Question: " + essayObject.getQuestionText());
         txtEssayAnswer.setEditable(false);
         
         String studentAnswer = essayObject.getStudentAnswer();
         if ((studentAnswer != null) && (!studentAnswer.trim().equals(""))) {
             txtEssayAnswer.setText(studentAnswer);
             String[] words = studentAnswer.split(" ");
             Integer numOfWords = words.length;
             this.labelNumOfWords.setText(numOfWords.toString());
         } else {
             txtEssayAnswer.setText("");
             this.labelNumOfWords.setText("0");
         }
         
         if (essayObject.getWordLimit() == -1) {
             labelWordLimit.setText("No limit");
         } else {
             labelWordLimit.setText(Integer.toString(essayObject.getWordLimit()));
         }
         
         this.labelEssayFullMarks.setText(Double.toString(essayObject.getMark()));
         txtFieldMarks.setText(Double.toString(essayObject.getStudentMark()));
         
     }
 }
