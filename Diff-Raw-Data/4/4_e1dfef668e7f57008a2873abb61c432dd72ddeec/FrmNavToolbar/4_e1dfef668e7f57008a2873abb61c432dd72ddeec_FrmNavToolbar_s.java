 /*
  * To change this template, choose Tools | Templates
  * and open the template in the editor.
  */
 
 /*
  * Users.java
  *
  * Created on 23/02/2013, 09:28:53
  */
 
 package restaurante.UI.Forms;
 
 import java.awt.Component;
 import java.awt.Container;
 import java.awt.Cursor;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
 import javax.swing.JCheckBox;
 import javax.swing.JComboBox;
 import javax.swing.JFrame;
 import javax.swing.JInternalFrame;
 import javax.swing.JSpinner;
 import javax.swing.JTextArea;
 import javax.swing.JTextField;
 import javax.swing.SpinnerNumberModel;
 import javax.swing.event.DocumentEvent;
 import javax.swing.event.DocumentListener;
 import restaurante.UI.CustomComponents.JButton;
 
 /**
  *
  * @author aluno
  */
 public abstract class FrmNavToolbar<Register> extends JFrame {
     public static final String FRAME_TITLE = "Cadastro de ";
     public static final String SAVE_SUCCESS = "Registro salvo com sucesso.";
     public static final String DELETE_CONFIRMATION = "Deseja realmente excluir este registro?";
     public static final String DELETE_SUCCESS = "Registro excluído com sucesso.";
     public static final String UNSAVE_CONFIRMATION = "Se você continuar, suas alterações"
             + " serão perdidas. Deseja mesmo continuar?";
     public static final String SAVE_ERROR = "Erro ao salvar o registro.";
     public static final String DELETE_ERROR = "Erro ao excluir o registro.";
     public static final String SEARCH_ERROR = "Não foi possível encontrar o registro.";
     
     /** Creates new form Users */
     public FrmNavToolbar() {
         initComponents();
         initDefaultProperties();
         verifyListPosition();
         this.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
     }
 
     protected final void initDefaultProperties() {
         //setClosable(true);
         //setIconifiable(true);
         //setMaximizable(true);
         setResizable(true);
         setDefaultClose();
         setChanged(this);
         btnNew.setEnabled(false);
         btnSave.setEnabled(false);
         btnDelete.setEnabled(false);
         String prvTitle = this.getTitle();
         this.setTitle(FRAME_TITLE + prvTitle);
     }
 
     private void setDefaultClose() {
         setDefaultCloseOperation(JInternalFrame.DISPOSE_ON_CLOSE);
     }
 
     /** This method is called from within the constructor to
      * initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is
      * always regenerated by the Form Editor.
      */
     @SuppressWarnings("unchecked")
     // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
     private void initComponents() {
 
         jToolBar1 = new javax.swing.JToolBar();
         btnFirst = new JButton();
         btnPrevious = new JButton();
         btnNext = new restaurante.UI.CustomComponents.JButton();
         btnLast = new restaurante.UI.CustomComponents.JButton();
         jSeparator1 = new javax.swing.JToolBar.Separator();
         btnSearch = new restaurante.UI.CustomComponents.JButton();
         jSeparator2 = new javax.swing.JToolBar.Separator();
         btnSave = new restaurante.UI.CustomComponents.JButton();
         btnNew = new restaurante.UI.CustomComponents.JButton();
         btnDelete = new restaurante.UI.CustomComponents.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
 
         jToolBar1.setRollover(true);
         jToolBar1.setMaximumSize(new java.awt.Dimension(this.getMaximumSize().width, 33));
         jToolBar1.setMinimumSize(new java.awt.Dimension(this.getMinimumSize().width, 33));
         jToolBar1.setPreferredSize(new java.awt.Dimension(this.getPreferredSize().width, 33));
 
         btnFirst.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/Primeiro.png"))); // NOI18N
         btnFirst.setDebugGraphicsOptions(javax.swing.DebugGraphics.BUFFERED_OPTION);
         btnFirst.setDoubleBuffered(true);
         btnFirst.setFocusable(false);
         btnFirst.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnFirst.setMaximumSize(new java.awt.Dimension(32, 32));
         btnFirst.setMinimumSize(new java.awt.Dimension(32, 32));
         btnFirst.setPreferredSize(new java.awt.Dimension(32, 32));
         btnFirst.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnFirst.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnFirstActionPerformed(evt);
             }
         });
         jToolBar1.add(btnFirst);
 
         btnPrevious.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/Voltar.png"))); // NOI18N
         btnPrevious.setDebugGraphicsOptions(javax.swing.DebugGraphics.BUFFERED_OPTION);
         btnPrevious.setDoubleBuffered(true);
         btnPrevious.setFocusable(false);
         btnPrevious.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnPrevious.setMaximumSize(new java.awt.Dimension(32, 32));
         btnPrevious.setMinimumSize(new java.awt.Dimension(32, 32));
         btnPrevious.setPreferredSize(new java.awt.Dimension(32, 32));
         btnPrevious.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnPrevious.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnPreviousActionPerformed(evt);
             }
         });
         jToolBar1.add(btnPrevious);
 
         btnNext.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/Proximo.png"))); // NOI18N
         btnNext.setFocusable(false);
         btnNext.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnNext.setMaximumSize(new java.awt.Dimension(32, 32));
         btnNext.setMinimumSize(new java.awt.Dimension(32, 32));
         btnNext.setPreferredSize(new java.awt.Dimension(32, 32));
         btnNext.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnNext.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnNextActionPerformed(evt);
             }
         });
         jToolBar1.add(btnNext);
 
         btnLast.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/ultimo.png"))); // NOI18N
         btnLast.setFocusable(false);
         btnLast.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnLast.setMaximumSize(new java.awt.Dimension(32, 32));
         btnLast.setMinimumSize(new java.awt.Dimension(32, 32));
         btnLast.setPreferredSize(new java.awt.Dimension(32, 32));
         btnLast.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnLast.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnLastActionPerformed(evt);
             }
         });
         jToolBar1.add(btnLast);
         jToolBar1.add(jSeparator1);
 
         btnSearch.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/Pesquisar.png"))); // NOI18N
         btnSearch.setFocusable(false);
         btnSearch.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnSearch.setMaximumSize(new java.awt.Dimension(32, 32));
         btnSearch.setMinimumSize(new java.awt.Dimension(32, 32));
         btnSearch.setPreferredSize(new java.awt.Dimension(32, 32));
         btnSearch.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnSearch.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnSearchActionPerformed(evt);
             }
         });
         jToolBar1.add(btnSearch);
         jToolBar1.add(jSeparator2);
 
         btnSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/Salvar.png"))); // NOI18N
         btnSave.setFocusable(false);
         btnSave.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnSave.setMaximumSize(new java.awt.Dimension(32, 32));
         btnSave.setMinimumSize(new java.awt.Dimension(32, 32));
         btnSave.setPreferredSize(new java.awt.Dimension(32, 32));
         btnSave.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnSave.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnSaveActionPerformed(evt);
             }
         });
         jToolBar1.add(btnSave);
 
         btnNew.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/1362250667_New_File.png"))); // NOI18N
         btnNew.setFocusable(false);
         btnNew.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnNew.setMaximumSize(new java.awt.Dimension(32, 32));
         btnNew.setMinimumSize(new java.awt.Dimension(32, 32));
         btnNew.setPreferredSize(new java.awt.Dimension(32, 32));
         btnNew.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnNew.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnNewActionPerformed(evt);
             }
         });
         jToolBar1.add(btnNew);
 
         btnDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/restaurante/Images/Excluir.png"))); // NOI18N
         btnDelete.setFocusable(false);
         btnDelete.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
         btnDelete.setMaximumSize(new java.awt.Dimension(32, 32));
         btnDelete.setMinimumSize(new java.awt.Dimension(32, 32));
         btnDelete.setPreferredSize(new java.awt.Dimension(32, 32));
         btnDelete.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
         btnDelete.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 btnDeleteActionPerformed(evt);
             }
         });
         jToolBar1.add(btnDelete);
 
         javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addComponent(jToolBar1, javax.swing.GroupLayout.DEFAULT_SIZE, 650, Short.MAX_VALUE)
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(layout.createSequentialGroup()
                 .addComponent(jToolBar1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                 .addContainerGap(65, Short.MAX_VALUE))
         );
 
         pack();
     }// </editor-fold>//GEN-END:initComponents
 
     private void btnFirstActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFirstActionPerformed
         goToFirstRegister();
         btnNew.setEnabled(true);
         btnDelete.setEnabled(true);
         btnSave.setEnabled(false);
     }//GEN-LAST:event_btnFirstActionPerformed
 
 private void btnPreviousActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPreviousActionPerformed
         goToPreviousRegister();
         btnNew.setEnabled(true);
         btnDelete.setEnabled(true);
         btnSave.setEnabled(false);
 }//GEN-LAST:event_btnPreviousActionPerformed
 
 private void btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDeleteActionPerformed
         deleteRegister();
 }//GEN-LAST:event_btnDeleteActionPerformed
 
 private void btnNextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNextActionPerformed
         goToNextRegister();
         btnNew.setEnabled(true);
         btnDelete.setEnabled(true);
         btnSave.setEnabled(false);
 }//GEN-LAST:event_btnNextActionPerformed
 
 private void btnLastActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLastActionPerformed
         goToLastRegister();
         btnNew.setEnabled(true);
         btnDelete.setEnabled(true);
         btnSave.setEnabled(false);
 }//GEN-LAST:event_btnLastActionPerformed
 
 private void btnSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveActionPerformed
         saveRegister();
         btnSave.setEnabled(false);
         btnNew.setEnabled(true);
         btnDelete.setEnabled(true);
 }//GEN-LAST:event_btnSaveActionPerformed
 
 private void btnNewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNewActionPerformed
         newRegister();
         btnSave.setEnabled(false);
         btnNew.setEnabled(false);
         btnDelete.setEnabled(false);
 }//GEN-LAST:event_btnNewActionPerformed
 
 private void btnSearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSearchActionPerformed
     // TODO add your handling code here:
     searchRegister();
     btnNew.setEnabled(false);
     btnDelete.setEnabled(true);
     btnNew.setEnabled(true);
 }//GEN-LAST:event_btnSearchActionPerformed
 
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton btnDelete;
     private javax.swing.JButton btnFirst;
     private javax.swing.JButton btnLast;
     private javax.swing.JButton btnNew;
     private javax.swing.JButton btnNext;
     private javax.swing.JButton btnPrevious;
     protected javax.swing.JButton btnSave;
     private javax.swing.JButton btnSearch;
     private javax.swing.JToolBar.Separator jSeparator1;
     private javax.swing.JToolBar.Separator jSeparator2;
     private javax.swing.JToolBar jToolBar1;
     // End of variables declaration//GEN-END:variables
     
     private Register[] list;
     
     public void setList(Register[] list) {
         this.list = list;
         verifyListPosition();
     }
     
     private int getListSize() {
         if(list == null) { 
             return 0;
         }
         return list.length;
     }
     
     private int currentRegisterPosition = -1;
     
     public abstract boolean saveRegister();
     
     public abstract boolean deleteRegister();
     
     public final void verifyListPosition() {
         btnFirst.setEnabled(true);
         btnLast.setEnabled(true);
         btnNext.setEnabled(true);
         btnPrevious.setEnabled(true);
         if(getListSize() == 0) {
             btnFirst.setEnabled(false);
             btnLast.setEnabled(false);
             btnNext.setEnabled(false);
             btnPrevious.setEnabled(false);
             btnSearch.setEnabled(false);
         } else {
             btnSearch.setEnabled(true);
             if(currentRegisterPosition == -1 || currentRegisterPosition == 0) {
                 btnFirst.setEnabled(false);
                 btnPrevious.setEnabled(false);
             }
             if(currentRegisterPosition == getListSize() - 1) {
                 btnNext.setEnabled(false);
                 btnLast.setEnabled(false);
             }
         }
     }
     
     public void newRegister() {
         currentRegisterPosition = -1;
         cleanForm(this);
         verifyListPosition();
         btnNew.setEnabled(false);
         btnDelete.setEnabled(false);
         btnSave.setEnabled(false);
         setNewRegisterInController();
     }
     
     public void goToFirstRegister() {
         currentRegisterPosition = 0;
         verifyListPosition();
         if(getListSize() == 0) {
             return;
         }
         getValues(list[currentRegisterPosition]);
     }
     
     public void goToPreviousRegister() {
         if(currentRegisterPosition - 1 >= 0) {
             currentRegisterPosition--;
         }
         verifyListPosition();
         if(getListSize() == 0) {
             currentRegisterPosition = 0;
             return;
         }
         getValues(list[currentRegisterPosition]);
     }
     
     public void goToNextRegister() {
         if(currentRegisterPosition + 1 < getListSize()) {
             currentRegisterPosition++;
         } else {
             return;
         }
         verifyListPosition();
         if(getListSize() == 0) {
             currentRegisterPosition = 0;
             return;
         }
         getValues(list[currentRegisterPosition]);
     }
     
     public void goToLastRegister() {
         currentRegisterPosition = getListSize() - 1;
         verifyListPosition();
         if(getListSize() == 0) {
             currentRegisterPosition = 0;
             return;
         }
         getValues(list[currentRegisterPosition]);
     }
 
     public abstract void getValues(Register register);
 
     public void cleanForm(Container parent) {
         Component[] components = parent.getComponents();
 
         for (Component component : components)
         {
             if (component instanceof JTextField)
             {
                 ((JTextField)component).setText("");
                 continue;
             }
             if (component instanceof JSpinner)
             {
                 JSpinner spinner = ((JSpinner)component);
                 Object minValue = ((SpinnerNumberModel)spinner.getModel()).getMinimum();
                 spinner.setValue(minValue);
                 continue;
             }
             if (component instanceof JTextArea)
             {
                 ((JTextArea)component).setText("");
                 continue;
             }
             if (component instanceof JCheckBox)
             {
                 ((JCheckBox)component).setSelected(false);
                 continue;
             }
             if(component instanceof JComboBox) {
                 ((JComboBox)component).setSelectedIndex(0);
                 continue;
             }
             if(component instanceof Container) {
                 cleanForm((Container)component);
                 continue;
             }
         }
     }
 
     public void setChanged(Container parent) {
         Component[] components = parent.getComponents();
 
         for (Component component : components)
         {
             if (component instanceof JTextField)
             {
                 addJTextFieldListener((JTextField)component);
                 continue;
             }
             if (component instanceof JTextArea)
             {
                 addJTextFieldListener((JTextArea)component);
                 continue;
             }
             if (component instanceof JCheckBox)
             {
                 ((JCheckBox)component).addActionListener(new ActionListener() {
 
                     public void actionPerformed(ActionEvent e) {
                         enableSaveAndNew();
                     }
                 });
                 continue;
             }
             if(component instanceof JComboBox) {
                 ((JComboBox)component).addActionListener(new ActionListener() {
 
                     public void actionPerformed(ActionEvent e) {
                         enableSaveAndNew();
                     }
                 });
                 continue;
             }
             if(component instanceof Container) {
                 setChanged((Container)component);
                 continue;
             }
         }
     }
 
     private void addJTextFieldListener(JTextField component) {
         component.getDocument().addDocumentListener(new DocumentListener() {
 
             public void insertUpdate(DocumentEvent e) {
                 enableSaveAndNew();
             }
 
             public void removeUpdate(DocumentEvent e) {
                 enableSaveAndNew();
             }
 
             public void changedUpdate(DocumentEvent e) {
                 enableSaveAndNew();
             }
         });
     }
     
     private void addJTextFieldListener(JTextArea component) {
         component.getDocument().addDocumentListener(new DocumentListener() {
 
             public void insertUpdate(DocumentEvent e) {
                 enableSaveAndNew();
             }
 
             public void removeUpdate(DocumentEvent e) {
                 enableSaveAndNew();
             }
 
             public void changedUpdate(DocumentEvent e) {
                 enableSaveAndNew();
             }
         });
     }
     
     protected void enableSaveAndNew() {
         btnSave.setEnabled(true);
         btnNew.setEnabled(true);        
     }
     
     public abstract void setNewRegisterInController();
 
     public abstract void resetList();
 
     public abstract void searchRegister();
 }
