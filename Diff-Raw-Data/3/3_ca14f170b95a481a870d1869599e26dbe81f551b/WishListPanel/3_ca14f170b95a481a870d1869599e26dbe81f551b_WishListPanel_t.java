 package interiores.presentation.swing.views;
 
 import interiores.business.controllers.DesignController;
 import interiores.business.controllers.FurnitureTypeController;
 import interiores.core.Debug;
 import interiores.core.presentation.SwingController;
 import java.util.Collection;
 import javax.swing.JPanel;
 import javax.swing.tree.DefaultMutableTreeNode;
 import javax.swing.tree.DefaultTreeModel;
 
 /**
  *
  * @author alvaro
  */
 public class WishListPanel extends JPanel {
 
     private DesignController designController;
     private FurnitureTypeController furnitureTypeController;
     
     /** Creates new form WishListPanel */
     public WishListPanel(SwingController presentation) {
         initComponents();
         
         designController = presentation.getBusinessController(DesignController.class);
         furnitureTypeController = presentation.getBusinessController(FurnitureTypeController.class);
     }
     
     private void solveDesign() {
         if (debugCheckBox.isSelected()) {
             designController.debug(timeCheckBox.isSelected());
         }
         else {
             designController.solve(timeCheckBox.isSelected());
         }
     }
     
     public void updateSelectable() {
         Collection<String> selectableFurniture = furnitureTypeController.getSelectableFurniture();
         DefaultTreeModel model = (DefaultTreeModel) selectable.getModel();
         DefaultMutableTreeNode root = (DefaultMutableTreeNode) model.getRoot();
         for (String sf: selectableFurniture) {
             root.add(new DefaultMutableTreeNode(sf));
         }
 
     }    
     public void updateSelected() {
         Collection<String> selectedFurniture = furnitureTypeController.getRoomFurniture();
         selected.setListData(selectedFurniture.toArray(new String[selectedFurniture.size()]));
     }
     /** This method is called from within the constructor to
      * initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is
      * always regenerated by the Form Editor.
      */
     @SuppressWarnings("unchecked")
     // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
     private void initComponents() {
 
         scrollSelectable = new javax.swing.JScrollPane();
         selectable = new javax.swing.JTree();
         scrollSelected = new javax.swing.JScrollPane();
         selected = new javax.swing.JList();
         solveButton = new javax.swing.JButton();
         debugCheckBox = new javax.swing.JCheckBox();
         timeCheckBox = new javax.swing.JCheckBox();
 
         javax.swing.tree.DefaultMutableTreeNode treeNode1 = new javax.swing.tree.DefaultMutableTreeNode("Selectable Types");
         selectable.setModel(new javax.swing.tree.DefaultTreeModel(treeNode1));
         selectable.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
         selectable.setShowsRootHandles(true);
         selectable.addMouseListener(new java.awt.event.MouseAdapter() {
             public void mouseClicked(java.awt.event.MouseEvent evt) {
                 selectableMouseClicked(evt);
             }
         });
         scrollSelectable.setViewportView(selectable);
 
         selected.addMouseListener(new java.awt.event.MouseAdapter() {
             public void mouseClicked(java.awt.event.MouseEvent evt) {
                 selectedMouseClicked(evt);
             }
         });
         scrollSelected.setViewportView(selected);
 
         solveButton.setText("Solve design");
         solveButton.setActionCommand("solve");
         solveButton.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 solveButtonActionPerformed(evt);
             }
         });
 
         debugCheckBox.setText("Debug");
 
         timeCheckBox.setText("Time");
 
         javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
         this.setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(layout.createSequentialGroup()
                 .addContainerGap()
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                     .addGroup(layout.createSequentialGroup()
                         .addComponent(solveButton)
                         .addGap(18, 18, 18)
                         .addComponent(debugCheckBox)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                         .addComponent(timeCheckBox)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                     .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                             .addComponent(scrollSelectable, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 275, Short.MAX_VALUE)
                             .addComponent(scrollSelected, javax.swing.GroupLayout.DEFAULT_SIZE, 275, Short.MAX_VALUE))
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                 .addGap(14, 14, 14))
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(layout.createSequentialGroup()
                 .addContainerGap()
                 .addComponent(scrollSelectable, javax.swing.GroupLayout.PREFERRED_SIZE, 284, javax.swing.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                 .addComponent(scrollSelected, javax.swing.GroupLayout.PREFERRED_SIZE, 271, javax.swing.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 27, Short.MAX_VALUE)
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                     .addComponent(solveButton)
                     .addComponent(debugCheckBox)
                     .addComponent(timeCheckBox))
                 .addContainerGap())
         );
     }// </editor-fold>//GEN-END:initComponents
 
 private void solveButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_solveButtonActionPerformed
     solveDesign();
 }//GEN-LAST:event_solveButtonActionPerformed
 
 private void selectedMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_selectedMouseClicked
     if (evt.getClickCount() >= 2) { // Double click or faster
         int index = selected.getSelectedIndex();
         if (index >= 0) {
             String type = (String) selected.getModel().getElementAt(index);
             Debug.println("Removing: " + type);
             furnitureTypeController.unselect(type);
             updateSelected();
         }
     }
 }//GEN-LAST:event_selectedMouseClicked
 
 private void selectableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_selectableMouseClicked
     if (evt.getClickCount() >= 2) { // Double click or faster
         DefaultMutableTreeNode node = (DefaultMutableTreeNode)
                        selectable.getLastSelectedPathComponent();
 
 
         if (node != null) {
             String nodeInfo = (String) node.getUserObject();
             if (node.isLeaf()) {
                Debug.println("Adding a: " + nodeInfo);
                 furnitureTypeController.select(nodeInfo);
             }
             updateSelected();
         }
     }
 }//GEN-LAST:event_selectableMouseClicked
 
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JCheckBox debugCheckBox;
     private javax.swing.JScrollPane scrollSelectable;
     private javax.swing.JScrollPane scrollSelected;
     private javax.swing.JTree selectable;
     private javax.swing.JList selected;
     private javax.swing.JButton solveButton;
     private javax.swing.JCheckBox timeCheckBox;
     // End of variables declaration//GEN-END:variables
 }
